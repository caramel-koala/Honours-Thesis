\section{Executing the Merge}
Once the best merge is found and the error deemed to be lower than the maximum error threshold, the merge can begin to be executed. While the merge execution on the CPU is nearly identical to that of the sequential merge algorithm, the changes must also be reflected in the GPU's representation of the data, should the merge process continue, so that the correct new merge can be obtained in the next iteration.

\subsection{CPU Merge}
As stated the CPU merge is nearly identical to that of the sequential merge with the exception being that the parallel CPU merge function takes in a list containing the positions of the cells to be merged instead of being passed pointers to their location in memory.

\subsection{GPU Merge}
The best merge in the \texttt{results} array is copied back to the GPU and the kernel \texttt{d\_do\_merge} is called to execute the merge on the GPU with the same grid and block parameters as the \texttt{d\_get\_best} kernel. The kernel begins by using the \texttt{cuda.grid} function to get the global thread ID of the processing thread and checks to see if the thread is within the range of the number of cells. The \texttt{related} array is iterated over and any element containing the value of the related merging cell, \texttt{best[4]}, is changed to the value of the main merging cell, \texttt{best[5]}.
\\
\\
Next, the thread ID is checked to be equal to that of the main merging cell. This thread change the values of the coordinates, intensity and error of the main merging cell to that of the merged cell. The related cells of the related merging cell are appended to those of the main merging cell's list in the \texttt{related} array. The sources of the related merging cell are appended to that of the main merging cells in \texttt{sources}.
\\
\\
The function finally checks the thread ID to see if it is that of the related merging cell. This thread changes the values of the position and intensity of the cell to that of the maximum error threshold, to ensure it will be unable to merge with any other cells and sets its error to zero in the \texttt{centre} array.
\\
\\
Once these changes have been made, the kernel ends its execution and the process begins again until the maximum error is reached.